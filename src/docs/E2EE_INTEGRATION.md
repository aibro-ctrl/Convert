# End-to-End –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (E2EE) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üîê –û–±–∑–æ—Ä

–ß–∞—Ç "–ö–æ–Ω–≤–µ—Ä—Ç" —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ end-to-end —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:

- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
- ‚úÖ –°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–Ω–µ—á–∏—Ç–∞–µ–º—ã–π)
- ‚úÖ –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:
- **RSA-OAEP 2048** - –¥–ª—è –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏
- **AES-GCM 256** - –¥–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤
- **PBKDF2** - –¥–ª—è –∑–∞—â–∏—Ç—ã –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –ø–∞—Ä–æ–ª–µ–º
- **Web Crypto API** - –Ω–∞—Ç–∏–≤–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª—é—á–µ–π:
1. **–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á** - —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º
2. **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á** - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –ø–∞—Ä–æ–ª–µ–º, —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
3. **–ö–ª—é—á–∏ –∫–æ–º–Ω–∞—Ç** - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ

## üìÅ –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏:
- `/utils/crypto.ts` - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `/contexts/CryptoContext.tsx` - React –∫–æ–Ω—Ç–µ–∫—Å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞–º–∏
- `/utils/messageEncryption.ts` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- `/supabase/functions/server/crypto.tsx` - —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `PUT /users/public-key` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
- `GET /rooms/:roomId/key` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –∫–æ–º–Ω–∞—Ç—ã
- `POST /rooms/:roomId/keys` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```typescript
// –í Register.tsx (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
const handleSignup = async () => {
  await signup(email, password, username);
  // AuthContext –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–∞—Ä–æ–ª—å –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
  // CryptoContext –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
};
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —Å –ø–∞—Ä–æ–ª–µ–º
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–∞—Ä–∞ RSA –∫–ª—é—á–µ–π (–ø—É–±–ª–∏—á–Ω—ã–π + –ø—Ä–∏–≤–∞—Ç–Ω—ã–π)
3. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —à–∏—Ñ—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
5. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ

### 2. –í—Ö–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```typescript
// –í Login.tsx (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
const handleLogin = async () => {
  await signin(email, password);
  // CryptoContext –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
};
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç —Å –ø–∞—Ä–æ–ª–µ–º
2. CryptoContext –Ω–∞—Ö–æ–¥–∏—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏
3. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–æ–ª—è
4. –ö–ª—é—á–∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (DM)

```typescript
// –í DirectMessageChat.tsx (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
import { useCrypto } from '../../contexts/CryptoContext';
import { encryptMessageContent } from '../../utils/messageEncryption';

const ChatComponent = () => {
  const cryptoContext = useCrypto();
  
  const handleSend = async (content: string) => {
    // –®–∏—Ñ—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è
    const encrypted = await encryptMessageContent(
      content,
      cryptoContext,
      undefined, // roomId –¥–ª—è DM –Ω–µ –Ω—É–∂–µ–Ω
      recipientId // ID –ø–æ–ª—É—á–∞—Ç–µ–ª—è
    );
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await dmAPI.send(dmId, encrypted, 'text');
  };
};
```

### 4. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–æ–º–Ω–∞—Ç—É

```typescript
// –í ChatRoom.tsx (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
import { useCrypto } from '../../contexts/CryptoContext';
import { encryptMessageContent } from '../../utils/messageEncryption';

const ChatRoom = ({ room }) => {
  const cryptoContext = useCrypto();
  
  const handleSendMessage = async (content: string) => {
    // –®–∏—Ñ—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª—é—á–æ–º –∫–æ–º–Ω–∞—Ç—ã (AES)
    const encrypted = await encryptMessageContent(
      content,
      cryptoContext,
      room.id, // ID –∫–æ–º–Ω–∞—Ç—ã
      undefined // recipientId –¥–ª—è –∫–æ–º–Ω–∞—Ç –Ω–µ –Ω—É–∂–µ–Ω
    );
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await messagesAPI.send(room.id, encrypted, 'text');
  };
};
```

### 5. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏

```typescript
// –í MessageList.tsx (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
import { useCrypto } from '../../contexts/CryptoContext';
import { decryptMessageContent } from '../../utils/messageEncryption';

const MessageItem = ({ message }) => {
  const cryptoContext = useCrypto();
  const [decryptedContent, setDecryptedContent] = useState('');
  
  useEffect(() => {
    // –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
    decryptMessageContent(message.content, cryptoContext, message)
      .then(setDecryptedContent)
      .catch(() => setDecryptedContent('[–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å]'));
  }, [message.content]);
  
  return <div>{decryptedContent}</div>;
};
```

### 6. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º

```typescript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–Ω–∞—Ç—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
import { initializeRoomEncryption } from '../../utils/messageEncryption';

const createRoom = async (name, memberIds) => {
  // –°–æ–∑–¥–∞–µ–º –∫–æ–º–Ω–∞—Ç—É
  const room = await roomsAPI.create(name, 'private');
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  await initializeRoomEncryption(room.id, memberIds, cryptoContext);
  
  return room;
};
```

### 7. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –∫–æ–º–Ω–∞—Ç—É

```typescript
// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
import { addMemberToEncryptedRoom } from '../../utils/messageEncryption';

const addMember = async (roomId, userId) => {
  // –î–æ–±–∞–≤–ª—è–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞
  await roomsAPI.addMember(roomId, userId);
  
  // –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –µ–º—É –¥–æ—Å—Ç—É–ø –∫ –∫–ª—é—á—É –∫–æ–º–Ω–∞—Ç—ã
  await addMemberToEncryptedRoom(roomId, userId, cryptoContext);
};
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

#### 1. ChatRoom.tsx
**–ì–¥–µ:** –§—É–Ω–∫—Ü–∏—è `handleSendMessage` (—Å—Ç—Ä–æ–∫–∞ ~177)
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```typescript
// –ë–´–õ–û:
await messagesAPI.send(room.id, content, type, replyTo);

// –°–¢–ê–õ–û:
const encrypted = await encryptMessageContent(content, cryptoContext, room.id);
await messagesAPI.send(room.id, encrypted, type, replyTo);
```

#### 2. DirectMessageChat.tsx
**–ì–¥–µ:** –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```typescript
// –ë–´–õ–û:
await dmAPI.send(dm.id, content, 'text');

// –°–¢–ê–õ–û:
const recipientId = dm.participants.find(id => id !== user.id);
const encrypted = await encryptMessageContent(content, cryptoContext, undefined, recipientId);
await dmAPI.send(dm.id, encrypted, 'text');
```

#### 3. MessageList.tsx / MessageItem
**–ì–¥–µ:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å —Ö—É–∫ –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
const [displayContent, setDisplayContent] = useState(message.content);

useEffect(() => {
  decryptMessageContent(message.content, cryptoContext, message)
    .then(setDisplayContent);
}, [message.content]);

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å displayContent –≤–º–µ—Å—Ç–æ message.content
```

#### 4. CreateRoom.tsx
**–ì–¥–µ:** –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```typescript
const newRoom = await roomsAPI.create(name, type);
if (type === 'private') {
  await initializeRoomEncryption(newRoom.id, selectedMembers, cryptoContext);
}
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ:
‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–µ–∫—Å—Ç, —É–ø–æ–º–∏–Ω–∞–Ω–∏—è, —Ä–µ–ø–ª–∞–∏)
‚úÖ –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö
‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö

### –ß—Ç–æ –ù–ï –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ):
- –ò–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ù–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç
- –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ê–≤–∞—Ç–∞—Ä—ã
- –†–µ–∞–∫—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ emoji)

### –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è:

‚ö†Ô∏è **–ü–æ—Ç–µ—Ä—è –ø–∞—Ä–æ–ª—è = –ø–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—è–º**
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å, –æ–Ω –ù–ï –°–ú–û–ñ–ï–¢ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –¥–∞–∂–µ –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è.

‚ö†Ô∏è **–†–µ–∂–∏–º "–ì–ª–∞–∑ –ë–æ–≥–∞"**
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä iBro –≤ —Ä–µ–∂–∏–º–µ "–ì–ª–∞–∑ –ë–æ–≥–∞" —É–≤–∏–¥–∏—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–µ—á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç), —Ç–∞–∫ –∫–∞–∫ —É –Ω–µ–≥–æ –Ω–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

‚ö†Ô∏è **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–ø–æ–º–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å, —Ç–∞–∫ –∫–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π –∫–æ–º–Ω–∞—Ç –≤ –ø–∞–º—è—Ç–∏
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ Lazy loading —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è)
- ‚úÖ –ì–∏–±—Ä–∏–¥–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (RSA + AES) –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `decryptMessages()` –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –•—Ä–∞–Ω–∏—Ç–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º state

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:

1. **–°–æ–∑–¥–∞–π—Ç–µ –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
2. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ**
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å JSON —Å `ciphertext`, `iv`, `version`
4. **–í–æ–π–¥–∏—Ç–µ –≤—Ç–æ—Ä—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º** - —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** - –∏—â–∏—Ç–µ –ª–æ–≥–∏ "E2EE: ..."

### –ü—Ä–∏–º–µ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î:
```json
{
  "version": "v1",
  "ciphertext": "dGVzdCBjaXBoZXJ0ZXh0...",
  "iv": "cmFuZG9tIGl2...",
  "encryptedKey": "ZW5jcnlwdGVkIGFlcyBrZXk=" // —Ç–æ–ª—å–∫–æ –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ
}
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–∞–∫ –µ—Å—Ç—å.
–ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

## ‚ùì FAQ

**Q: –ß—Ç–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–º–µ–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞?**
A: –£—Ç–∏–ª–∏—Ç–∞ `encryptMessageContent` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤—ã–¥–∞—Å—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è?**
A: –ù–µ—Ç. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω —Å—Ç–∞—Ä—ã–º –ø–∞—Ä–æ–ª–µ–º. –ü—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å).

**Q: –í–ª–∏—è–µ—Ç –ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å?**
A: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ. Web Crypto API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—Ç–∏–≤–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞, —á—Ç–æ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ?**
A: –î–∞, –ø—Ä–æ—Å—Ç–æ –Ω–µ –≤—ã–∑—ã–≤–∞–π—Ç–µ `encryptMessageContent` –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ plain text.

## üéØ Roadmap

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ RSA –∏ AES
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏ –∫–æ–º–Ω–∞—Ç
- ‚úÖ –°–µ—Ä–≤–µ—Ä–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- ‚úÖ –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
- ‚è≥ ChatRoom.tsx - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚è≥ DirectMessageChat.tsx - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö DM
- ‚è≥ MessageList.tsx - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏
- ‚è≥ CreateRoom.tsx - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–µ–π –Ω–æ–≤—ã—Ö –∫–æ–º–Ω–∞—Ç
- ‚è≥ AddMember - –≤—ã–¥–∞—á–∞ –∫–ª—é—á–µ–π –Ω–æ–≤—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

### –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
- üîú –ü–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è
- üîú –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –∫–ª—é—á–µ–π –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- üîú –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ UI
- üîú –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª—é—á–µ–π (–∑–∞—â–∏—Ç–∞ –æ—Ç MITM)

---

**–ê–≤—Ç–æ—Ä:** AI Assistant –¥–ª—è Figma Make
**–í–µ—Ä—Å–∏—è:** 1.0.0
**–î–∞—Ç–∞:** 01.12.2025
