# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–∞—Ç–∞ "–ö–æ–Ω–≤–µ—Ä—Ç" –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–≠–∫—Å–ø–æ—Ä—Ç –∏–∑ Figma Make](#—ç–∫—Å–ø–æ—Ä—Ç-–∏–∑-figma-make)
3. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞)
4. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
5. [–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#–º–∏–≥—Ä–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
7. [Troubleshooting](#troubleshooting)

---

## üéØ –û–±–∑–æ—Ä

### –ó–∞—á–µ–º –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å?

**Figma Make** - –æ—Ç–ª–∏—á–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–æ –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- ‚ùå –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å Supabase (–Ω–µ–ª—å–∑—è –∑–∞–º–µ–Ω–∏—Ç—å backend)
- ‚ùå –ù–µ—Ç –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ —Å–µ—Ä–≤–µ—Ä–æ–º
- ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ Supabase
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å PocketBase + Redis** –¥–∞–µ—Ç:
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å–∞–º–æ—Ö–æ—Å—Ç–∏–Ω–≥
- ‚úÖ –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ü–æ–ª–Ω–∞—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –õ–µ–≥–∫–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ß—Ç–æ –º—ã –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å?

```
Figma Make (Supabase)  ‚Üí  –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–¥–∞  ‚Üí  –°–≤–æ–π —Å–µ—Ä–≤–µ—Ä (PocketBase + Redis)
```

1. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º frontend –∫–æ–¥ –∏–∑ Figma Make
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase
3. –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º PocketBase + Redis –Ω–∞ —Å–≤–æ–µ–º —Å–µ—Ä–≤–µ—Ä–µ
4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
5. –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º frontend –Ω–∞ –Ω–æ–≤—ã–π backend

---

## üì§ –≠–∫—Å–ø–æ—Ä—Ç –∏–∑ Figma Make

### –®–∞–≥ 1: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–¥–∞

**–í Figma Make:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç "–ö–æ–Ω–≤–µ—Ä—Ç"
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É **"Export"** –∏–ª–∏ **"Download"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"Download as ZIP"**
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∞—Ä—Ö–∏–≤ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä

```bash
# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞
unzip konvert-chat.zip
cd konvert-chat
```

### –®–∞–≥ 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π Supabase

**–í–ê–ñ–ù–û:** –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –î–û —ç–∫—Å–ø–æ—Ä—Ç–∞!

1. –í Figma Make –æ—Ç–∫—Ä–æ–π—Ç–µ Settings ‚Üí API
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - `SUPABASE_URL`
   - `SUPABASE_ANON_KEY`
   - `SUPABASE_SERVICE_ROLE_KEY` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.backup`:

```env
VITE_SUPABASE_URL=https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.supabase.co
VITE_SUPABASE_ANON_KEY=–≤–∞—à_anon_key
SUPABASE_SERVICE_ROLE_KEY=–≤–∞—à_service_role_key
```

### –®–∞–≥ 3: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∞–¥–∞–ø—Ç–µ—Ä–∞

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É `/backend-adapter` –∏–∑ —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ –∫–æ—Ä–µ–Ω—å –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
mkdir -p backend-adapter/migration
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ /backend-adapter
```

---

## üñ•Ô∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ:**
- CPU: 1 core
- RAM: 512 MB
- –î–∏—Å–∫: 10 GB
- –û–°: Ubuntu 20.04+, Debian 11+, –∏–ª–∏ macOS

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:**
- CPU: 2 cores
- RAM: 2 GB
- –î–∏—Å–∫: 50 GB SSD
- –û–°: Ubuntu 22.04 LTS

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

#### Ubuntu/Debian:

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker $USER

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
exit
# (–í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ)

# –ü—Ä–æ–≤–µ—Ä–∫–∞
docker --version
docker-compose --version
```

#### macOS:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ Homebrew
brew install --cask docker

# –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ Docker Desktop:
# https://www.docker.com/products/docker-desktop/
```

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd backend-adapter/migration

# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x install.sh

# –ó–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
./install.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞–ª–∏—á–∏–µ Docker
2. ‚úÖ –°–æ–∑–¥–∞—Å—Ç .env —Ñ–∞–π–ª —Å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏
3. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç PocketBase + Redis
4. ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
5. ‚úÖ –ü—Ä–µ–¥–ª–æ–∂–∏—Ç –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏**, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–≤–µ–¥–µ—Ç —Å–∫—Ä–∏–ø—Ç!

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

#### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
cd backend-adapter/migration
cp .env.example .env
nano .env
```

–ò–∑–º–µ–Ω–∏—Ç–µ:
```env
VITE_BACKEND_TYPE=pocketbase
VITE_POCKETBASE_URL=http://localhost:8090
POCKETBASE_ADMIN_EMAIL=admin@konvert.chat
POCKETBASE_ADMIN_PASSWORD=–≤–∞—à_—Å–∏–ª—å–Ω—ã–π_–ø–∞—Ä–æ–ª—å

# –í—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á–∏ Supabase –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
VITE_SUPABASE_URL=https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.supabase.co
VITE_SUPABASE_ANON_KEY=–≤–∞—à_anon_key
SUPABASE_SERVICE_ROLE_KEY=–≤–∞—à_service_role_key
```

#### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
mkdir -p pb_data pb_migrations backups data

# –ó–∞–ø—É—Å–∫ Docker Compose
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps
```

–í—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
```
NAME                COMMAND             STATUS
konvert_pocketbase  "serve ..."         Up
konvert_redis       "redis-server ..."  Up
```

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

```bash
# PocketBase
curl http://localhost:8090/api/health
# –û—Ç–≤–µ—Ç: {"status":"ok"}

# Redis
docker exec konvert_redis redis-cli ping
# –û—Ç–≤–µ—Ç: PONG
```

---

## üíæ –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

```bash
cd backend-adapter/migration

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (—ç–∫—Å–ø–æ—Ä—Ç + –∏–º–ø–æ—Ä—Ç)
npm run migrate:auto
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ—à–∞–≥–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

#### –®–∞–≥ 1: –≠–∫—Å–ø–æ—Ä—Ç –∏–∑ Supabase

```bash
npm run migrate:export
```

–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `data/export.json` —Å –¥–∞–Ω–Ω—ã–º–∏:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –ö–æ–º–Ω–∞—Ç—ã
- –°–æ–æ–±—â–µ–Ω–∏—è
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- –ó–∞–ø—Ä–æ—Å—ã –¥—Ä—É–∂–±—ã

#### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
ls -lh data/export.json

# –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
cat data/export.json | jq '.users | length'
cat data/export.json | jq '.messages | length'
```

#### –®–∞–≥ 3: –ò–º–ø–æ—Ä—Ç –≤ PocketBase

```bash
npm run migrate:import
```

–ü—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
```
üîÑ Connecting to PocketBase...
üîê Authenticating...
üìã Creating collections...
   ‚úì Collection "users" exists
   ‚úì Created collection "rooms"
   ...
üë• Importing users...
   ‚úì Imported: 150, Skipped: 0
üí¨ Importing messages...
   ‚úì Imported: 5420, Skipped: 0
‚úÖ Import complete!
```

#### –®–∞–≥ 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–û—Ç–∫—Ä–æ–π—Ç–µ PocketBase Admin:
```
http://localhost:8090/_/
```

–í–æ–π–¥–∏—Ç–µ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ `.env` —Ñ–∞–π–ª–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ö–æ–ª–ª–µ–∫—Ü–∏—è `users` –∑–∞–ø–æ–ª–Ω–µ–Ω–∞
- –ö–æ–ª–ª–µ–∫—Ü–∏—è `rooms` –∑–∞–ø–æ–ª–Ω–µ–Ω–∞
- –ö–æ–ª–ª–µ–∫—Ü–∏—è `messages` –∑–∞–ø–æ–ª–Ω–µ–Ω–∞

---

## üèóÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ frontend

### –®–∞–≥ 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ `.env`:

```env
VITE_BACKEND_TYPE=pocketbase
VITE_POCKETBASE_URL=http://localhost:8090
VITE_E2EE_ENABLED=true
VITE_REALTIME_ENABLED=true
```

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
npm install

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è PocketBase
npm install pocketbase
```

### –®–∞–≥ 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–¥–∞–ø—Ç–µ—Ä–∞

–û–±–Ω–æ–≤–∏—Ç–µ `src/utils/api.ts`:

```typescript
import { getBackendConfig, BACKEND_TYPE } from '../backend-adapter/config';
import PocketBaseAdapter from '../backend-adapter/pocketbase-adapter';
import { IBackendAdapter } from '../backend-adapter/interface';

// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∞–¥–∞–ø—Ç–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
let adapter: IBackendAdapter;

if (BACKEND_TYPE === 'pocketbase') {
  adapter = new PocketBaseAdapter();
} else {
  // Fallback –Ω–∞ Supabase (—Ç–µ–∫—É—â–∏–π –∫–æ–¥)
  adapter = ... // –≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
}

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ API
export const authAPI = {
  signup: adapter.signup.bind(adapter),
  signin: adapter.signin.bind(adapter),
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
};
```

### –®–∞–≥ 4: –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# Development
npm run dev

# Production
npm run build
npm run preview
```

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://localhost:5173`

---

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 1. Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `/etc/nginx/sites-available/konvert`:

```nginx
server {
    listen 80;
    server_name chat.example.com;
    
    # Redirect to HTTPS
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl http2;
    server_name chat.example.com;

    ssl_certificate /etc/letsencrypt/live/chat.example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/chat.example.com/privkey.pem;

    # Frontend
    location / {
        root /var/www/konvert/dist;
        try_files $uri $uri/ /index.html;
    }

    # PocketBase API
    location /api/ {
        proxy_pass http://localhost:8090;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # PocketBase Admin
    location /_/ {
        proxy_pass http://localhost:8090;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```bash
sudo ln -s /etc/nginx/sites-available/konvert /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 2. SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot
sudo apt install certbot python3-certbot-nginx

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo certbot --nginx -d chat.example.com

# –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
sudo certbot renew --dry-run
```

### 3. Systemd service –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ `/etc/systemd/system/konvert.service`:

```ini
[Unit]
Description=Konvert Chat Services
Requires=docker.service
After=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/path/to/konvert/backend-adapter/migration
ExecStart=/usr/local/bin/docker-compose up -d
ExecStop=/usr/local/bin/docker-compose down
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
```

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ:

```bash
sudo systemctl enable konvert
sudo systemctl start konvert
sudo systemctl status konvert
```

### 4. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `/usr/local/bin/backup-konvert.sh`:

```bash
#!/bin/bash

BACKUP_DIR="/backups/konvert"
DATE=$(date +%Y%m%d_%H%M%S)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p "$BACKUP_DIR"

# Backup PocketBase
tar -czf "$BACKUP_DIR/pocketbase_$DATE.tar.gz" /path/to/pb_data

# Backup Redis
docker exec konvert_redis redis-cli --rdb /data/dump.rdb SAVE
cp /path/to/redis/dump.rdb "$BACKUP_DIR/redis_$DATE.rdb"

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (>30 –¥–Ω–µ–π)
find "$BACKUP_DIR" -mtime +30 -delete

echo "Backup completed: $DATE"
```

–°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ cron:

```bash
sudo chmod +x /usr/local/bin/backup-konvert.sh

# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab
sudo crontab -e

# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø –≤ 2:00
0 2 * * * /usr/local/bin/backup-konvert.sh >> /var/log/konvert-backup.log 2>&1
```

### 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∞–∑–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Netdata
bash <(curl -Ss https://my-netdata.io/kickstart.sh)

# –ò–ª–∏ Grafana + Prometheus –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: PocketBase –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker logs konvert_pocketbase

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
sudo lsof -i :8090

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart pocketbase
```

### –ü—Ä–æ–±–ª–µ–º–∞: Redis –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker exec konvert_redis redis-cli ping

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
docker exec konvert_redis redis-cli -a –≤–∞—à_–ø–∞—Ä–æ–ª—å ping

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker logs konvert_redis
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π

```bash
# –û—á–∏—Å—Ç–∫–∞ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞
rm -rf data/export.json
npm run migrate:export -- --force

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase
curl -H "apikey: –≤–∞—à_anon_key" "https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.supabase.co/rest/v1/"
```

### –ü—Ä–æ–±–ª–µ–º–∞: Frontend –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ PocketBase

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS –≤ PocketBase Admin ‚Üí Settings ‚Üí CORS
2. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origins
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `VITE_POCKETBASE_URL` –≤ `.env`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `http://` –∏–ª–∏ `https://` –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞: E2EE –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π
# –í PocketBase Admin –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é users
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–µ public_key —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# –ï—Å–ª–∏ –∫–ª—é—á–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã:
# 1. –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
# 2. –í–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ —Å –ø–∞—Ä–æ–ª–µ–º
# 3. –ö–ª—é—á–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | Supabase (Figma Make) | PocketBase (–°–≤–æ–π —Å–µ—Ä–≤–µ—Ä) |
|---------|----------------------|--------------------------|
| Latency | ~100-300ms | ~10-50ms |
| Throughput | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–ª–∞–Ω–∞ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∂–µ–ª–µ–∑–æ–º |
| Real-time | WebSocket | WebSocket |
| –°—Ç–æ–∏–º–æ—Å—Ç—å | $0-25+/–º–µ—Å | $0 (+ —Å–µ—Ä–≤–µ—Ä) |
| –ö–æ–Ω—Ç—Ä–æ–ª—å | –û–≥—Ä–∞–Ω–∏—á–µ–Ω | –ü–æ–ª–Ω—ã–π |

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

- [ ] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–æ–¥ –∏–∑ Figma Make
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∫–ª—é—á–∏ Supabase
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker + Docker Compose
- [ ] –ó–∞–ø—É—â–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã PocketBase + Redis
- [ ] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤ PocketBase
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è frontend
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω real-time
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω HTTPS (–ø—Ä–æ–¥–∞–∫—à–µ–Ω)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [PocketBase Documentation](https://pocketbase.io/docs/)
- [Redis Documentation](https://redis.io/docs/)
- [Docker Documentation](https://docs.docker.com/)
- [Nginx Documentation](https://nginx.org/en/docs/)

---

## üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs`
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ [Troubleshooting](#troubleshooting)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `.env`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ—Ä—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞:** 01.12.2025  
**–ê–≤—Ç–æ—Ä:** AI Assistant –¥–ª—è —á–∞—Ç–∞ "–ö–æ–Ω–≤–µ—Ä—Ç"

**–£—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏!** üöÄ
